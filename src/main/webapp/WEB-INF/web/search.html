<%
var selected1;
%>

<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="UTF-8">
	<title>Moki | Book</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="format-detection" content="telephone=no">
	<meta name="renderer" content="webkit">
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<link rel="alternate icon" type="image/png" href="${ctxPath}/Amazeui/i/favicon.png">
	<link rel="stylesheet" href="${ctxPath}/Amazeui/css/amazeui.min.css"/>
	<link rel="stylesheet" href="${ctxPath}/chosen/amazeui.chosen.css"/>
	<style>
		.header {
			text-align: center;
		}
		.header h1 {
			font-size: 200%;
			color: #333;
			margin-top: 30px;
		}
		.header p {
			font-size: 14px;
		}
	</style>
</head>
<body>
<div class="header">
	<div class="am-g">
		<h1>Moki | Book</h1>
		<p>摩奇图书借阅查询系统</p>
	</div>
	<hr />
</div>
<div class="am-g">
	<div class="am-u-lg-6 am-u-md-8 am-u-sm-centered">
		<div>
			<form id="pagerForm" action="${ctxPath}/web" method="post" class="am-form">

				<input type="hidden" name="pageSize" value="${page.pageSize}" />
				<input type="hidden" id="pageCurrent" name="pageCurrent" value="${page.pageCurrent}" />

				<input type="hidden" id="name" name="name" value="${borrowbook.name}" />
				<input type="hidden" id="booktypeid" name="booktypeid" value="${borrowbook.booktypeid}" />


				<label for="name">书名：</label>
				<input type="text"  id="name2" name="name2" value="${borrowbook.name!}" class="am-text am-text-xl" size="12"/>


				<label for="name">图书分类：</label>
				<select data-am-selected id="booktypeid2" name="booktypeid2" class="my-select">
					<option value="">请输入查询条件</option>
					<%
					selected1 = "";
					for(obj in booktypeList!)
					{
					if(isEmpty(borrowbook.booktypeid) || obj.id != borrowbook.booktypeid)
					{
					selected1="";
					}else{
					selected1 = "selected='selected'";
					}
					println("<option value='" + obj.id + "'"+selected1+">"+obj.name+"</option>");
					}
					%>
				</select>

				<div style="margin-top: 5px;">
					<input type="button" name="" value="查 询" class="am-btn am-btn-primary am-btn-sm " onclick="onSearch()">
					<input type="button" name="" value="清空查询" class="am-btn am-btn-warning am-btn-sm" onclick="onClear()">
				</div>


			</form>
		</div>

		<hr>



			<ul data-am-widget="pagination" style="margin-left: -2px;" class="am-pagination am-pagination-default am-pagination-xs">

				<%
				for(var i=1;i<=page.pageCount;i++){
				var at = (i == page.pageCurrent ? "am-active" : "");
				%>
				<li class="${at}">
					<a href="javascript:void(0)" onclick="onPage(${i})" class="${at}">${i}</a>
				</li>

				<%
				}
				%>
			</ul>


		<div class="am-text-nowrap">
			<table class="am-table am-table-bordered am-table-striped am-text-nowrap am-table-compact">
				<thead>
				<tr>
					<th>书名(点击书名查看详细借阅者)</th>
					<th width="50">总数</th>
					<th width="50">已借数</th>
				</tr>
				</thead>
				<tbody>

					<%
					for(obj in list_obj){
					%>

					<tr >

						<td>
							<a href="${ctxPath}/web/borrower?barcode=${obj.barcode}" >${obj.name!}</a>
						</td>

						<td>
							${obj.num!}
						</td>

						<td>
							${obj.borrownum!}
						</td>


					</tr>
					<%}%>

				</tbody>
			</table>
		</div>

		<div>

			<ul data-am-widget="pagination" style="margin-left: -2px;" class="am-pagination am-pagination-default">
				<!--
				<li class="am-pagination-first ">
					<a href="${ctxPath}/web?pageNumber=1" class="">第一页</a>
				</li>
				-->
				<%
				for(var i=1;i<=page.pageCount;i++){
					var at = (i == page.pageCurrent ? "am-active" : "");
				%>
				<li class="${at}">
					<a href="javascript:void(0)" onclick="onPage(${i})" class="${at}">${i}</a>
				</li>

				<%
				}
				%>
				<!--
				<li class="am-pagination-last ">
					<a href="${ctxPath}/web?pageNumber=${page.pageCount}" class="">最末页</a>
				</li>
				-->
			</ul>
		</div>

		<hr>
		<p>© 2015 Moki Book. by zhongwei</p>


	</div>

</div>
</body>

</html>

<script src="${ctxPath}/Amazeui/js/jquery.min.js"></script>
<script src="${ctxPath}/chosen/amazeui.chosen.min.js"></script>

<script>
	function onClear()
	{
		$("#name").val("");
		$("#booktypeid").val("");
		$("#pageCurrent").val(1);
		$("#pagerForm").submit();
	}

	$(function() {
		$('.my-select').chosen({
			disable_search:true
		});
	});

	function onSearch()
	{
		$("#name").val($("#name2").val());
		$("#booktypeid").val($("#booktypeid2").val());

		$("#pageCurrent").val(1);
		$("#pagerForm").submit();
	}

	function onPage(pageNum)
	{
		$("#pageCurrent").val(pageNum);
		$("#pagerForm").submit();

	}
</script>


